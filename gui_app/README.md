# gui_app
该项目是基于面向对象编程，是供水管网震后水力分析软件V1.0的重构。

## 历史记录
- 2020-10-5 重新运行程序，检查程序错误，撰写技术文档及测试文件。
- 2020-10-5 构建start_toolkit.m，该函数源于EPANET-Matlab Toolkit。目的是将程序下的文件路径添加到Matlab检索路径中。可以创建窗口，但是运行会出现错误。
- 2020-10-8 发现文件，开发方向：1.每次模拟显示模拟次数。2.不再重复加载动态链接库（疑似产生bug的主要原因）
-----
# 附录：试验记录
### 试验1-蒙特卡罗抽样次数为5
#### 描述/步骤
1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为5，如图所示

![试验输入](https://github.com/lookforhan/appforWDN/blob/dev-check/gui_app/%E8%AF%95%E9%AA%8C/%E8%AF%95%E9%AA%8C1.PNG)
#### 结果

顺利完成运行，生成预期的结果文件。[命令行记录](./试验/试验1)

matlab

生成奇怪的文件，名字为“sl5o.1”等，如图所示

![计划外文件](https://github.com/lookforhan/appforWDN/blob/dev-check/gui_app/%E8%AF%95%E9%AA%8C/%E8%AF%95%E9%AA%8C1_%E8%AE%A1%E5%88%92%E5%A4%96%E6%96%87%E4%BB%B6.png)
#### 初步结论
在模拟次数为5时，软件可以正常运行。但是显示的警告信息，表面程序是存在问题的。

### 试验2-蒙特卡罗抽样次数为10
#### 描述/步骤
1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为10，如图所示

![试验输入](https://github.com/lookforhan/appforWDN/blob/dev-check/gui_app/%E8%AF%95%E9%AA%8C/%E8%AF%95%E9%AA%8C2.png)
#### 结果

顺利完成运行，生成预期的结果文件。[命令行记录](./试验/试验2)

matlab

生成奇怪的文件，如图所示

![计划外文件](https://github.com/lookforhan/appforWDN/blob/dev-check/gui_app/%E8%AF%95%E9%AA%8C/%E8%AF%95%E9%AA%8C2_%E8%AE%A1%E5%88%92%E5%A4%96%E6%96%87%E4%BB%B6.png)
#### 初步结论
在模拟次数为10时，软件可以正常运行。但是显示的警告信息，表面程序是存在问题的。

注意：在运行模拟前，将输出结果文件夹清空。
### 试验3-蒙特卡罗抽样次数为100
#### 描述/步骤
1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为100，如图所示

![试验输入](.\试验\试验3.png)
#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验3)

matlab

生成奇怪的文件，如图所示

![计划外文件](.\试验\试验3_计划外文件.png)
#### 初步结论
在模拟次数为100时，软件出现错误。在运行到35次时出现错误。
注意：在运行模拟前，将输出结果文件夹清空。
### 试验4-蒙特卡罗抽样次数为50
#### 描述/步骤
1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为50，如图所示

![试验输入](.\试验\试验3.png)
#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验4)

matlab




#### 初步结论
在模拟次数为100时，软件出现错误。在运行到35次时出现错误。
注意：在运行模拟前，将输出结果文件夹清空。
### 试验5-蒙特卡罗抽样次数为36
#### 描述/步骤
1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为100，如图所示

![试验输入](.\试验\试验5.png)
#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验5)

matlab

生成奇怪的文件
#### 初步结论
在模拟次数为36时，软件出现错误。在运行到35次时出现错误。
注意：在运行模拟前，未将输出结果文件夹清空，保留一个文件。
### 试验6-蒙特卡罗抽样次数为100
#### 修改
此次修改了曾向
Model中，先判断是否需要加载DLL;输出MC次数，运行时开启diary on。
PDD_run1中，先判断是否需要加载DLL
#### 描述/步骤


1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为100，如图所示

![试验输入](.\试验\试验6.png)
#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验6)

matlab

生成奇怪的文件
#### 初步结论
在模拟次数为100时，软件出现错误。在运行到35次时出现错误。
仍然存在问题，但是判断次出问题出现在PDD_run1中的Get_chosen_node_value

### 试验7-重复试验6设置
#### 修改
此次修改了曾向
Model中，先判断是否需要加载DLL;输出MC次数，运行时开启diary on。
PDD_run1中，先判断是否需要加载DLL
#### 描述/步骤


1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为100，如图所示


#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验7)

matlab

生成奇怪的文件
#### 初步结论
确认为“判断出问题出现在PDD_run1中的Get_chosen_node_value”
并且查看了第35次模拟生成的[inp文件](./试验/试验7-damageNet_35.inp)，产生的破坏太严重，仅有1个节点保留下来。
### 试验8-重复试验7设置
#### 修改
没有关闭matlab，直接重新模拟，结果运行顺利。
#### 描述/步骤


1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为100，如图所示


#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验8)

matlab

生成奇怪的文件
#### 初步结论
可以认为次出随机抽样结果没有出现极端情况，因此所有抽样可以顺利模拟。
### 试验9-重复试验8设置
#### 修改
没有关闭matlab，直接重新模拟。
#### 描述/步骤


1.运行start_toolkit.m
2.运行main.m
3.在图形界面中输入案例管网，输出文件夹，以及rr文件，蒙特卡罗抽样次数为100，如图所示


#### 结果

运行错误，终于出现错误。[命令行记录](./试验/试验9)

matlab

生成奇怪的文件
#### 初步结论
在第18次模拟出现问题。

一定是抽样产生的破坏太多，导致无法顺利运行。
